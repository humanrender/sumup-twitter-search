class SessionsController < ApplicationController
  def create
    auth = request.env["omniauth.auth"]
    session[:twitter_token] = auth["credentials"]["token"]
    session[:twitter_secret] = auth["credentials"]["secret"]
    redirect_to root_url, :notice => "Signed in!"
  end

  def destroy
    session[:twitter_token] = nil
    session[:twitter_secret] = nil
    redirect_to root_url, :notice => "Signed out!"
  end
end

# {"provider":"twitter","uid":"28534538","info":{"nickname":"humanrender","name":"Sergio Ramirez","location":"Madrid","image":"http://pbs.twimg.com/profile_images/488681498145337345/frnOwitn_normal.png","description":"=^.^=","urls":{"Website":null,"Twitter":"https://twitter.com/humanrender"}},"credentials":{"token":"28534538-lEM6GMapynVGu9DZxySH4G7iKVnEyuizxXEMiTNkq","secret":"tWlsr7W7ZxW9jQ9grc3XTJAoYRj3Xgg9pgxNZp666XjVi"},"extra":{"access_token":{"token":"28534538-lEM6GMapynVGu9DZxySH4G7iKVnEyuizxXEMiTNkq","secret":"tWlsr7W7ZxW9jQ9grc3XTJAoYRj3Xgg9pgxNZp666XjVi","consumer":{"key":"dGqh23YMYcZUFkR8dizki8XCo","secret":"CeEQ1gDsQqGQBNLzOTbNtmNJwpn40GbYuzsV1EOB1H0tvqB6dN","options":{"signature_method":"HMAC-SHA1","request_token_path":"/oauth/request_token","authorize_path":"/oauth/authenticate","access_token_path":"/oauth/access_token","proxy":null,"scheme":"header","http_method":"post","oauth_version":"1.0","site":"https://api.twitter.com"},"http":{"address":"api.twitter.com","port":443,"local_host":null,"local_port":null,"curr_http_version":"1.1","keep_alive_timeout":2,"last_communicated":null,"close_on_empty_response":false,"socket":null,"started":false,"open_timeout":30,"read_timeout":30,"continue_timeout":null,"debug_output":null,"proxy_from_env":true,"proxy_uri":null,"proxy_address":null,"proxy_port":null,"proxy_user":null,"proxy_pass":null,"use_ssl":true,"ssl_context":{"cert":null,"key":null,"client_ca":null,"ca_file":null,"ca_path":null,"timeout":null,"verify_mode":0,"verify_depth":null,"renegotiation_cb":null,"verify_callback":null,"options":-2147482625,"cert_store":null,"extra_chain_cert":null,"client_cert_cb":null,"tmp_dh_callback":null,"session_id_context":null,"session_get_cb":null,"session_new_cb":null,"session_remove_cb":null,"servername_cb":null,"npn_protocols":null,"npn_select_cb":null},"ssl_session":{},"enable_post_connection_check":true,"sspi_enabled":false,"ca_file":null,"ca_path":null,"cert":null,"cert_store":null,"ciphers":null,"key":null,"ssl_timeout":null,"ssl_version":null,"verify_callback":null,"verify_depth":null,"verify_mode":0},"http_method":"post","uri":{"scheme":"https","user":null,"password":null,"host":"api.twitter.com","port":443,"path":"","query":null,"opaque":null,"registry":null,"fragment":null,"parser":null}},"params":{"oauth_token":"28534538-lEM6GMapynVGu9DZxySH4G7iKVnEyuizxXEMiTNkq","oauth_token_secret":"tWlsr7W7ZxW9jQ9grc3XTJAoYRj3Xgg9pgxNZp666XjVi","user_id":"28534538","screen_name":"humanrender"},"response":{"cache-control":["no-cache, no-store, must-revalidate, pre-check=0, post-check=0"],"connection":["close"],"content-length":["566"],"content-type":["application/json;charset=utf-8"],"date":["Tue, 11 Nov 2014 14:44:58 UTC"],"expires":["Tue, 31 Mar 1981 05:00:00 GMT"],"last-modified":["Tue, 11 Nov 2014 14:44:58 GMT"],"pragma":["no-cache"],"server":["tsa_b"],"set-cookie":["lang=en","guest_id=v1%3A141571709889760491; Domain=.twitter.com; Path=/; Expires=Thu, 10-Nov-2016 14:44:58 UTC"],"status":["200 OK"],"strict-transport-security":["max-age=631138519"],"x-access-level":["read"],"x-connection-hash":["ac904b6ee20d1ff42b918b8c509cc9f9"],"x-content-type-options":["nosniff"],"x-frame-options":["SAMEORIGIN"],"x-rate-limit-limit":["15"],"x-rate-limit-remaining":["12"],"x-rate-limit-reset":["1415717963"],"x-transaction":["b6d2f91ec31c58be"],"x-xss-protection":["1; mode=block"]}},"raw_info":{"id":28534538,"id_str":"28534538","name":"Sergio Ramirez","screen_name":"humanrender","location":"Madrid","profile_location":null,"description":"=^.^=","url":null,"entities":{"description":{"urls":[]}},"protected":true,"followers_count":128,"friends_count":165,"listed_count":11,"created_at":"Fri Apr 03 09:52:23 +0000 2009","favourites_count":210,"utc_offset":-10800,"time_zone":"Greenland","geo_enabled":true,"verified":false,"statuses_count":3164,"lang":"en","contributors_enabled":false,"is_translator":false,"is_translation_enabled":false,"profile_background_color":"131516","profile_background_image_url":"http://abs.twimg.com/images/themes/theme14/bg.gif","profile_background_image_url_https":"https://abs.twimg.com/images/themes/theme14/bg.gif","profile_background_tile":true,"profile_image_url":"http://pbs.twimg.com/profile_images/488681498145337345/frnOwitn_normal.png","profile_image_url_https":"https://pbs.twimg.com/profile_images/488681498145337345/frnOwitn_normal.png","profile_link_color":"009999","profile_sidebar_border_color":"EEEEEE","profile_sidebar_fill_color":"EFEFEF","profile_text_color":"333333","profile_use_background_image":true,"default_profile":false,"default_profile_image":false,"following":false,"follow_request_sent":false,"notifications":false}}}
